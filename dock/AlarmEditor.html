<body>
<font face = arial>
Instrument: <input value = "Alarm-0" id = "alarm_id" onchange = "javascript: Alarm = this . value;" />
Host: <input value = "http://localhost:30019" id = "host_id" onchange = "javascript: HOST = this . value;" />

Graularity:
<input type = radio name = granulars id =    g1 onclick = "javascript: changeGranularity (1);" />1
<input type = radio name = granulars id =    g8 onclick = "javascript: changeGranularity (8);" />8
<input type = radio name = granulars id =   g64 onclick = "javascript: changeGranularity (64);" />64
<input type = radio name = granulars id =  g128 onclick = "javascript: changeGranularity (128);" checked />128
<input type = radio name = granulars id =  g512 onclick = "javascript: changeGranularity (512);" />512
<input type = radio name = granulars id = g2048 onclick = "javascript: changeGranularity (2048);" />2048

<br />

<div id = editor>

<div style="background: red; display: inline-block; padding: 4px; border-radius: 8px;">

<div id = chorus_div style = "background: #73AD21; border-radius: 12px; padding: 12px; display: inline-block; color: white;"><b>CORE</b>
<table style = "color: white;">
<tr><td>VOLUME:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'volume' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>

</tr>
<tr><td>PAN:</td><td><input type = number class = granular min = -8192 max = 8192 step = 128 id = 'pan' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>PITCH:</td><td><input type = number class = granular min = -8192 max = 8192 step = 128 id = 'vco/pitch' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>SENS:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'vco/sens' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
</table>
</div>


<div id = porta_div style = "background: #73AD21; border-radius: 12px; padding: 12px; display: inline-block; color: white; vertical-align: top;">
<table style = "color: white;">
<tr><td><b>PORTA:</b></td><td><input type = number min = 0 max = 1 step = 1 id = 'portamento/porta' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>TIME:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'portamento/time' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>LEGATO:</td><td><input type = number min = 0 max = 1 step = 1 id = 'portamento/legato' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>RAMP:</td><td><input type = number min = 0 max = 1 step = 1 id = 'portamento/ramp' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>HOLD:</td><td><input type = number min = 0 max = 1 step = 1 id = 'portamento/hold' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>TRANSPOSE:</td><td><input type = number class = granular min = -16384 max = 16384 step = 128 id = 'portamento/transpose' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>MODE:</td><td><input type = number class = granular min = -128 max = 16384 step = 128 id = 'portamento/mode' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
</table>
</div>

<div id = vco_div style = "background: #73AD21; border-radius: 12px; padding: 12px; display: inline-block; color: white; vertical-align: top;">
<table style = "color: white;">
<tr><td colspan = 2><b>VCO</b></td>
</tr>
<tr><td>FREQ:</td><td><input type = number class = granular min = -8192 max = 8192 step = 128 id = 'vco/freq' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>AMP:</td><td><input type = number class = granular min = -16384 max = 0 step = 128 id = 'vco/amp' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>RATIO:</td><td><input type = number min = 1 max = 24 step = 1 id = 'vco/ratio' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>WAVE:</td><td><input type = number min = 0 max = 2 step = 1 id = 'vco/wave' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
</table>
</div>

<div id = adsr_div style = "background: #73AD21; border-radius: 12px; padding: 12px; display: inline-block; color: white; vertical-align: top;">
<table style = "color: white;">
<tr><td colspan = 2><b>ADSR</b></td></tr>
<tr><td>ATTACK:</td>
<td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'adsr/attack' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>DECAY:</td>
<td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'adsr/decay' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>SUSTAIN:</td>
<td><input type = number class = granular min = -16384 max = 0 step = 128 id = 'adsr/sustain' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>RELEASE:</td>
<td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'adsr/release' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
</table>
</div>

<div id = lfo_div style = "background: #73AD21; border-radius: 12px; padding: 12px; display: inline-block; color: white; vertical-align: top;">
<table style = "color: white;">
<tr><td><b>LFO</b></td></tr>
<tr><td>SPEED:</td><td><input type = number class = granular min = -8192 max = 8192 step = 128 id = 'lfo/speed' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
<td>Vibrato:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'lfo/vibrato' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>WAVE:</td><td><input type = number min = 0 max = 4 step = 1 id = 'lfo/wave' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
<td>Tremolo:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'lfo/tremolo' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>PULSE:</td><td><input type = number class = granular min = -8192 max = 8192 step = 128 id = 'lfo/pulse' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
<td>Pan:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'lfo/pan' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>PHASE:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'lfo/phase' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
<td>Modulation:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'lfo/modulation' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
<tr><td>SYNC:</td><td><input type = number min = 0 max = 1 step = 1 id = 'lfo/sync' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
<td>Sens:</td>
<td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'lfo/sens' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td>
</tr>
</table>
</div>

<div id = delay_div style = "background: #73AD21; border-radius: 12px; padding: 12px; display: inline-block; color: white;"><b>DELAY</b>
<table style = "color: white;">
<tr><td>GATEWAY:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'delay/gateway' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>BALANCE:</td><td><input type = number class = granular min = -8192 max = 8192 step = 128 id = 'delay/balance' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>FEEDBACK:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'delay/feedback' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>TIME:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'delay/time' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
<tr><td>HIGHDAMP:</td><td><input type = number class = granular min = 0 max = 16384 step = 128 id = 'delay/highdamp' style = "width: 5em;" onchange = "javascript: Lunar (this);" /></td></tr>
</td></tr>
</table>
</div>

</div>

</div>

<script>

var Alarm = document . getElementById ('alarm_id') . value;
var HOST = document . getElementById ('host_id') . value;

var Lunar = function (el) {
  var url = HOST + "/Lunar/" + el . value + "/" + Alarm + "/" + el . id;
  console . log (url);
  var req = new XMLHttpRequest ();
  req . onreadystatechange = function () {
    if (req . readyState == 4 && req . status == 200)
      console . log (req . responseText);
  }
  req . open ("GET", url, true);
  req . send (null);
};

var changeGranularity = function (step) {
  var inputs = document . getElementsByClassName ('granular');
  for (var ind = 0; ind < inputs . length; ind++) inputs [ind] . step = step;
};

var Return = function (el) {
  var url = HOST + "/return/" + Alarm + "/" + el . id;
  console . log (url);
  var req = new XMLHttpRequest ();
  req . onreadystatechange = function () {
    if (req . readyState == 4 && req . status == 200)
      el . value = Number (req . responseText);
  }
  req . open ("GET", url, true);
  req . send (null);
};

var refresh = function () {
  var inputs = document . getElementById ('editor') . getElementsByTagName ('input');
  for (var ind = 0; ind < inputs . length; ind++) Return (inputs [ind]);
  inputs = document . getElementById ('editor') . getElementsByTagName ('select');
  for (var ind = 0; ind < inputs . length; ind++) Return (inputs [ind]);
};

document . onkeydown = function (e) {
  switch (e . keyCode) {
  case 90: document . getElementById ('g1') . checked = true; changeGranularity (1); break;
  case 88: document . getElementById ('g8') . checked = true; changeGranularity (8); break;
  case 67: document . getElementById ('g64') . checked = true; changeGranularity (64); break;
  case 86: document . getElementById ('g128') . checked = true; changeGranularity (128); break;
  case 66: document . getElementById ('g512') . checked = true; changeGranularity (512); break;
  case 78: document . getElementById ('g2048') . checked = true; changeGranularity (2048); break;
  default: break;
  }
};

refresh ();

if (document . getElementById ('g1') . checked) changeGranularity (1);
if (document . getElementById ('g8') . checked) changeGranularity (8);
if (document . getElementById ('g64') . checked) changeGranularity (64);
if (document . getElementById ('g128') . checked) changeGranularity (128);
if (document . getElementById ('g512') . checked) changeGranularity (512);
if (document . getElementById ('g2048') . checked) changeGranularity (2048);

</script>
</font>
</body>
